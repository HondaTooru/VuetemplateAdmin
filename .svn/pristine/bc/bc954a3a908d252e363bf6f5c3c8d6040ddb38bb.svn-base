webpackJsonp([7],{"7t4s":function(e,t,a){var n=a("QiJD");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("1f192e29",n,!0)},QiJD:function(e,t,a){(e.exports=a("FZ+f")(!1)).push([e.i,"\n.userlist .avatar {\n  width: 50px;\n  height: 50px;\n  background-position: center center;\n  background-repeat: no-repeat;\n  background-size: cover;\n  border-radius: 10px;\n  overflow: hidden;\n}\n.tip .rightSearch {\n  float: right;\n}\n.tip .rightSearch .input-with-select .el-input-group__prepend {\n    background-color: #fff;\n    width: 120px;\n}\n",""])},TUho:function(e,t,a){"use strict";t.d=function(e){return Object(n.a)({url:"/user/list",method:"get",params:e})},t.c=function(e){return Object(n.a)({url:"/user/update",method:"post",data:e})},t.b=function(e){return Object(n.a)({url:"/user/speech",method:"post",data:e})},t.a=function(e){return Object(n.a)({url:"/user/feedback",method:"get",params:e})};var n=a("vLgD")},liW0:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("BO1k"),r=a.n(n),i=a("woOf"),l=a.n(i),s=a("TUho"),o={name:"userslist",data:function(){return{list:[],CurrentPage:1,total:0,tablekey:0,loading:!0,dialogFormVisible:!1,updateBtn:!1,update:{},listQuery:{group:void 0,name:void 0,type:void 0,page:1,limit:10,sort:"+id"},rules:{freeBully:[{type:"number",require:!0,message:"请输入次数",trigger:"blur"}],freeGift:[{type:"number",require:!0,message:"请输入次数",trigger:"blur"}],freeSong:[{type:"number",require:!0,message:"请输入次数",trigger:"blur"}]}}},directives:{waves:a("cAgV").a},filters:{fomatGroup:function(e){return{1:"普通人员",2:"工作人员",3:"管理人员"}[e]}},created:function(){this.getUserList()},methods:{changeSpeech:function(e){var t=this,a=e.isSpeech?"禁言":"解除禁言";this.$confirm("您确认此用户"+a+"？","提示",{type:"warning"}).then(function(){Object(s.b)(e.row).then(function(a){e.isSpeech=!e.isSpeech,t.$message({type:"success",message:a.data.msg})})}).catch(function(e){return e})},handleSearch:function(){this.listQuery.name?this.getUserList():this.$refs.search.focus()},getUserList:function(){var e=this;this.loading=!0,Object(s.d)(this.listQuery).then(function(t){console.log(t),e.list=t.data.items,e.total=t.data.total,e.loading=!1})},handleViews:function(e){var t=this;this.update=l()({},e),this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},handleUpdate:function(){var e=this;this.$refs.dataForm.validate(function(t){if(t){var a=l()({},e.update);e.updateBtn=!0,Object(s.c)(a).then(function(t){e.updateBtn=!1;var a=!0,n=!1,i=void 0;try{for(var l,s=r()(e.list);!(a=(l=s.next()).done);a=!0){var o=l.value;if(e.update.id===o.id){var u=e.list[o];e.list.splice(u,1,e.update),e.dialogFormVisible=!1,e.$notify({title:"成功",message:t.data.msg,type:"success",duration:2e3});break}}}catch(e){n=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}})}})},handleCurrentChange:function(e){this.listQuery.page=e,this.getUserList()},handleSizeChange:function(e){this.listQuery.limit=e,this.getUserList()},handleGroup:function(){this.listQuery.page=1,this.CurrentPage=1,this.getUserList()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"userlist"},[a("el-dialog",{attrs:{title:"用户权限修改",visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"dataForm",attrs:{model:e.update,"label-position":"top",rules:e.rules}},[a("el-form-item",{attrs:{label:"用户组"}},[a("el-select",{model:{value:e.update.group,callback:function(t){e.$set(e.update,"group",t)},expression:"update.group"}},e._l(3,function(t){return a("el-option",{key:t,attrs:{value:t,label:e._f("fomatGroup")(t)}})}))],1),e._v(" "),1!==e.update.group?a("div",[a("el-form-item",{attrs:{label:"每日免费霸屏次数",prop:"freeBully"}},[a("el-input",{model:{value:e.update.freeBully,callback:function(t){e.$set(e.update,"freeBully",e._n(t))},expression:"update.freeBully"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"每日免费礼物/魔法棒次数",prop:"freeGift"}},[a("el-input",{model:{value:e.update.freeGift,callback:function(t){e.$set(e.update,"freeGift",e._n(t))},expression:"update.freeGift"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"每日免费点歌次数",prop:"freeSong"}},[a("el-input",{model:{value:e.update.freeSong,callback:function(t){e.$set(e.update,"freeSong",e._n(t))},expression:"update.freeSong"}})],1)],1):e._e(),e._v(" "),a("el-form-item",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",loading:e.updateBtn},nativeOn:{click:function(t){e.handleUpdate(t)}}},[e._v("确定")]),e._v(" "),a("el-button",{nativeOn:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"tip"},[a("div",{staticClass:"rightSearch"},[a("el-input",{ref:"search",staticClass:"input-with-select",attrs:{placeholder:"请输入用户名",clearable:""},on:{clear:e.getUserList},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.getUserList(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}},[a("el-select",{attrs:{slot:"prepend",placeholder:"请选择",clearable:""},on:{change:e.handleGroup},slot:"prepend",model:{value:e.listQuery.group,callback:function(t){e.$set(e.listQuery,"group",t)},expression:"listQuery.group"}},e._l(3,function(t){return a("el-option",{key:t,attrs:{value:t,label:e._f("fomatGroup")(t)}})})),e._v(" "),a("el-button",{directives:[{name:"waves",rawName:"v-waves"}],attrs:{slot:"append",type:"primary",icon:"el-icon-search"},nativeOn:{click:function(t){e.handleSearch(t)}},slot:"append"})],1)],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.tablekey,attrs:{border:"",data:e.list}},[a("el-table-column",{attrs:{prop:"id",label:"id",width:"50"}}),e._v(" "),a("el-table-column",{attrs:{prop:"realname",label:"昵称"}}),e._v(" "),a("el-table-column",{attrs:{label:"性别"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:t.row.sex?"":"danger"}},[e._v(e._s(t.row.sex?"男":"女"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"头像"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{staticClass:"avatar",style:{backgroundImage:"url("+e.row.avatar+")"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"city",label:"城市"}}),e._v(" "),a("el-table-column",{attrs:{label:"用户组"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("fomatGroup")(t.row.group))+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(a){e.handleViews(t.row)}}},[e._v("修改权限")]),e._v(" "),t.row.isSpeech?a("el-button",{attrs:{type:"danger"},nativeOn:{click:function(a){a.preventDefault(),e.changeSpeech(t.row)}}},[e._v("禁言")]):a("el-button",{attrs:{type:"success"},nativeOn:{click:function(a){a.preventDefault(),e.changeSpeech(t.row)}}},[e._v("解除禁言")])],1)]}}])})],1),e._v(" "),e.total?a("el-pagination",{staticStyle:{"margin-top":"20px","text-align":"right"},attrs:{background:"","current-page":e.CurrentPage,layout:"total, sizes, prev, pager, next, jumper",total:e.total,"page-size":e.listQuery.limit,"page-sizes":[10,20,30,50]},on:{"update:currentPage":function(t){e.CurrentPage=t},"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}):e._e()],1)},staticRenderFns:[]};var c=a("VU/8")(o,u,!1,function(e){a("7t4s")},null,null);t.default=c.exports}});